{% comment %} HUMANPEA product card (ALD-style) {% endcomment %}
{%- assign prod = card_product | default: product -%}
{%- assign first_image = prod.featured_media -%}
{%- assign second_image = prod.media[1] -%}

<div class="hp-card">
  <a href="{{ prod.url }}" class="hp-card__link" aria-label="{{ prod.title | escape }}">
    <div class="hp-card__media">
      {%- if first_image -%}
        {{ first_image | image_url: width: 900 | image_tag:
          loading: 'lazy',
          alt: first_image.alt | escape,
          class: 'hp-card__img hp-card__img--primary'
        }}
      {%- endif -%}

      {%- if second_image -%}
        {{ second_image | image_url: width: 900 | image_tag:
          loading: 'lazy',
          alt: second_image.alt | escape,
          class: 'hp-card__img hp-card__img--secondary'
        }}
      {%- endif -%}

      {%- if prod.available == false -%}
        <span class="hp-badge hp-badge--soldout">Sold out</span>
      {%- endif -%}
    </div>

    <div class="hp-card__meta">
      <h3 class="hp-card__title">{{ prod.title | escape }}</h3>
      <div class="hp-card__price">
        {%- render 'price', product: prod, price_class: 'price--end' -%}
      </div>
    </div>
  </a>

  {%- if prod.available and show_quick_add -%}
    <product-form class="hp-card__quick">
      {%- form 'product', prod, id: 'quick-add-' | append: prod.id, novalidate: 'novalidate' -%}
        {%- if prod.variants.size == 1 and prod.variants.first.available -%}
          <button
            type="submit"
            name="add"
            class="hp-btn hp-btn--quiet"
            data-add-to-cart
          >Add to cart</button>
        {%- else -%}
          <a href="{{ prod.url }}" class="hp-btn hp-btn--quiet">Select options</a>
        {%- endif -%}
      {%- endform -%}
    </product-form>
  {%- endif -%}
</div>
